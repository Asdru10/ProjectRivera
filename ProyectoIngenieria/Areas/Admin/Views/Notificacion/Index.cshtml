@{
    ViewData["Title"] = "Buzón de Notificaciones";
}

<div class="container bg-white p-4 rounded shadow">
    <div class="border-bottom pb-3 mb-4">
        <h2 class="titulo-formulario">
            Buzón de Notificaciones
        </h2>
    </div>

    <div class="mb-3">
        <button id="btnEliminarSeleccionadas" class="btn btn-danger">
            <i class="bi bi-trash"></i> Eliminar seleccionadas
        </button>
    </div>

    <div class="table-responsive">
        <table id="notificacionesTable" class="table table-bordered table-hover table-sm align-middle text-center">
            <thead class="table-success text-dark ">
                <tr>
                    <th><input type="checkbox" id="checkAll" /></th>
                    <th class ="text-center">Título</th>
                    <th class="text-center">Descripción</th>
                    <th class="text-center">Fecha</th>
                    <th class="text-center">Placa</th>
                    <th class="text-center">Modelo</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <a asp-controller="Home" asp-action="Index"
       class="btn btn-outline-success rounded-circle shadow p-3"
       style="position: fixed; bottom: 30px; right: 30px; z-index: 1050; width: 80px; height: 80px; display: flex; align-items: center; justify-content: center; font-size: 2rem;">
        <i class="bi bi-arrow-left"></i>
    </a>
</div>

@section Scripts {
    <!-- Script JS personalizado para notificaciones -->
    <script src="~/js/Notificacion.js"></script>

    <!-- Script para marcar como leídas una vez cargadas -->
    <script>
        // Este evento se dispara una vez que DataTables carga los datos por AJAX
        $('#notificacionesTable').on('xhr.dt', function () {
            fetch("/Admin/Notificacion/MarcarTodasComoLeidas", {
                method: "POST"
            }).then(() => {
                console.log("Notificaciones marcadas como leídas");
            });
        });
    </script>
}